<div
  class="flex-column center"
  style="gap: 1rem; height: 98%"
  (click)="clickSidebar(); $event.stopPropagation()"
>
  <!-- [@logoSwitch]="logoState" -->
  <div class="flex-column center" style="height: 86px">
    <img
      [@smallLogoSwitch]="smallLogoState"
      *ngIf="showSmallLogo"
      src="../assets/logos/logo-small-white.png"
      alt="Domain Pulse Logo"
      height="auto"
      width="50%"
      style="margin-top: 2rem; margin-bottom: 0.8rem"
    />
    <img
      [@fullLogoSwitch]="fullLogoState"
      *ngIf="showFullLogo"
      src="../assets/dp-logo-white.png"
      alt="Domain Pulse Logo"
      height="auto"
      width="85%"
      style="margin-top: 2rem; margin-bottom: 0.8rem"
    />
  </div>
  <div
    *ngFor="let domain of domains$ | async"
    (click)="selectDomain(domain); $event.stopPropagation()"
    class="domain flex-row align-center clickable-item"
    [ngClass]="{
      'selected-domain': domain.selected,
      'clickable-item': !_expanded
    }"
    [ngStyle]="{
      padding: expanded ? '0 0rem' : '0px',
      width: _expanded ? '90%' : 'fit-content',
      color: domain.selected ? 'black' : 'white'
    }"
  >
    <div class="circle-wrapper">
      <img [src]="domain.imageUrl" alt="Source logo" height="44px" />
      <!-- <img [src]="domain.imageUrl" alt="Source logo" height="44px" /> -->
    </div>
    <p
      style="overflow: hidden; white-space: nowrap; text-overflow: ellipsis"
      *ngIf="_expanded"
    >
      {{ domain.name }}
    </p>

    <div
      class="domain-name"
      *ngIf="domain.selected && _expanded"
      class="icons-container flex-row align-center"
    >
      <img
        (click)="toggleEditDomainModal(); $event.stopPropagation()"
        src="../assets/icons/pen-solid.svg"
        height="15px"
        class="clickable-item"
      />
      <img
        src="../assets/icons/grey-trash.svg"
        height="15px"
        (click)="toggleConfirmDeleteDomainModal(domain.id); $event.stopPropagation()"
        class="clickable-item"
      />
    </div>
  </div>
  <!-- Your dp-sidebar content here -->
  <!-- </div> -->

  <div
    (click)="toggleDomainModal(); $event.stopPropagation()"
    class="domain add-domain-plus flex-row align-center clickable-item"
    [ngStyle]="{
      padding: expanded ? '0 0rem' : '0px',
      width: _expanded ? '90%' : 'fit-content'
    }"
  >
    <div class="plus-wrapper flex-row center">
      <img src="../assets/icons/white-plus.svg" height="20px" />
    </div>
    <p class="domain-name" *ngIf="_expanded" style="color: white">
      add a domain
    </p>
  </div>

  <div
    class="domain flex-row align-center clickable-item"
    (click)="toggleProfileModal(); $event.stopPropagation()"
    [ngStyle]="{
      padding: expanded ? '0 0rem' : '0px',
      width: _expanded ? '90%' : 'fit-content',
      background: 'white',
      marginTop: 'auto'
    }"
  >
    <div class="circle-wrapper">
      <img
        [src]="(profileDetails$ | async)?.profileIcon"
        alt="Source logo"
        height="44px"
      />
    </div>
    <ng-container *ngIf="userDetails$ | async as userDetails">
      <p class="domain-name" *ngIf="_expanded" style="color: black">
        {{ userDetails.username }}
      </p>
    </ng-container>
    <div *ngIf="_expanded" class="icons-container flex-row align-center">
      <img src="../assets/icons/settings.svg" height="15px" />
    </div>
  </div>
</div>

<dp-modal-container
  [modalDisplay]="showAddDomainModal"
  (close)="toggleDomainModal()"
>
  <div class="flex-row modal" style="width: 70vw; height: 70vh; color: black">
    <div
      class="flex-column center modal-contents"
      style="flex-basis: 55%; gap: 0.7rem"
    >
      <div class="heading-container">
        <img
          src="../assets/icons/back-arrow-right-light.svg"
          alt="Back Arrow"
          class="icon back-arrow clickable-item"
          (click)="toggleDomainModal()"
        />

        <p class="modal-heading">Add a Domain</p>
      </div>
      <div class="flex-column center content" style="width: 80%; gap: 0.5rem">
        <div class="flex-row" style="width: 80%">
          <p class="modal-step-tag">1</p>
          <div class="flex-column" style="width: 100%">
            <p class="step-heading">Choose a name</p>
            <input
              class="default-input"
              [(ngModel)]="newDomainName"
              type="text"
            />
          </div>
        </div>

        <div class="flex-row" style="width: 80%">
          <p class="modal-step-tag">2</p>
          <div class="flex-column" style="width: 100%">
            <p class="step-heading">Add A Description</p>
            <input
              class="default-input"
              type="text"
              [(ngModel)]="newDomainDescription"
              placeholder=""
            />
          </div>
        </div>

        <div class="flex-row" style="width: 80%">
          <p class="modal-step-tag">3</p>

          <div class="flex-column" style="width: 100%">
            <p class="step-heading">Select Domain Icon</p>
            <div class="outer-flex-row sources-options">
              <div
                class="inner-flex-row"
                style="overflow-x: auto; display: flex"
              >
                <div
                  class="flex-column center"
                  style="
                    margin-right: 20px;
                    margin-left: 20px;
                    margin-top: 10px;
                    margin-bottom: 10px;
                  "
                >
                  <div class="wrapper-domain">
                    <div
                      class="file-upload clickable-item"
                      (click)="selectIcon('')"
                    >
                      <input
                        type="file"
                        (change)="onImageSelectedDomain($event)"
                        accept="image/*"
                        style="height: 100%; width: 100%; border-radius: 50%"
                      />
                      <img
                        *ngIf="imagePreviewDomain"
                        [src]="imagePreviewDomain"
                        alt="Preview"
                        class="preview-image"
                      />
                      <img
                        *ngIf="!imagePreviewDomain"
                        src="../assets/icons/up-arrow.svg"
                        class="profile-icon"
                        style="width: 1vw"
                      />
                    </div>
                  </div>
                </div>
                <div
                  *ngFor="let domain of domainNames"
                  class="default-icon clickable-item"
                  (click)="selectIcon(domain)"
                >
                  <div
                    class="circle-wrapper-domain flex-row center"
                    style="width: 100px; height: 100px"
                  >
                    <img
                      [src]="domain"
                      [ngClass]="{ selected: newDomainImageName === domain }"
                      alt="domain"
                    />
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="bottom-div">
        <button class="new-domain-btn clickable-item" (click)="addNewDomain()">
          Confirm
          <div [ngClass]="{ 'button-spinner': addDomainSpinner }"></div>
        </button>
      </div>
    </div>
    <div class="picture"></div>
  </div>
</dp-modal-container>

<dp-modal-container
  [modalDisplay]="showEditDomainModal"
  (close)="toggleEditDomainModal()"
>
  <div class="flex-row modal" style="width: 70vw; height: 70vh; color: black">
    <div
      class="flex-column center modal-contents"
      style="flex-basis: 55%; gap: 0.7rem"
    >
      <div class="heading-container">
        <img
          src="../assets/icons/back-arrow-right-light.svg"
          alt="Back Arrow"
          class="icon back-arrow clickable-item"
          (click)="toggleEditDomainModal()"
        />

        <p class="modal-heading">Edit a Domain</p>
      </div>
      <div class="flex-column center content" style="width: 80%; gap: 0.5rem">
        <div class="flex-row" style="width: 80%">
          <p class="modal-step-tag">1</p>
          <div class="flex-column" style="width: 100%">
            <p class="step-heading">Change Domain Name</p>
            <input
              class="default-input"
              [(ngModel)]="editDomainName"
              type="text"
            />
          </div>
        </div>

        <div class="flex-row" style="width: 80%">
          <p class="modal-step-tag">2</p>
          <div class="flex-column" style="width: 100%">
            <p class="step-heading">Change Description</p>
            <input
              class="default-input"
              [(ngModel)]="editDomainDescription"
              type="text"
            />
          </div>
        </div>

        <div class="flex-row" style="width: 80%">
          <p class="modal-step-tag">3</p>

          <div class="flex-column" style="width: 100%">
            <p class="step-heading">Change Domain Icon</p>
            <div class="outer-flex-row sources-options">
              <div
                class="inner-flex-row"
                style="overflow-x: auto; display: flex"
              >
                <div
                  class="flex-column center"
                  style="
                    margin-right: 20px;
                    margin-left: 20px;
                    margin-top: 10px;
                    margin-bottom: 10px;
                  "
                >
                  <div class="wrapper-domain">
                    <div
                      class="file-upload clickable-item"
                      (click)="selectIconEdit('')"
                    >
                      <input
                        type="file"
                        (change)="onImageSelectedDomainEdit($event)"
                        accept="image/*"
                        style="height: 100%; width: 100%; border-radius: 50%"
                      />
                      <img
                        *ngIf="imagePreviewDomainEdit"
                        [src]="imagePreviewDomainEdit"
                        alt="Preview"
                        class="preview-image"
                      />
                      <img
                        *ngIf="!imagePreviewDomainEdit"
                        src="../assets/icons/up-arrow.svg"
                        class="profile-icon"
                        style="width: 1vw"
                      />
                    </div>
                  </div>
                </div>
                <div
                  *ngFor="let domain of domainNames"
                  class="default-icon clickable-item"
                  (click)="selectIconEdit(domain)"
                >
                  <div
                    class="circle-wrapper-domain flex-row center"
                    style="width: 100px; height: 100px"
                  >
                    <img
                      [src]="domain"
                      [ngClass]="{ selected: editDomainImageName === domain }"
                      alt="domain"
                    />
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="bottom-div">
        <button class="new-domain-btn clickable-item" (click)="editDomain()">
          Confirm
          <div [ngClass]="{ 'button-spinner': editDomainSpinner }"></div>
        </button>
      </div>
    </div>
    <div class="picture"></div>
  </div>
</dp-modal-container>

<dp-modal-container
  [modalDisplay]="showProfileModal"
  (close)="toggleProfileModal()"
>
  <div class="flex-row modal" style="width: 70vw; height: 70vh; color: black">
    <div
      class="flex-column center modal-contents"
      style="flex-basis: 55%; gap: 0.7rem"
    >
      <div class="heading-container">
        <img
          src="../assets/icons/back-arrow-right-light.svg"
          alt="Back Arrow"
          class="back-arrow clickable-item"
          (click)="toggleProfileModal()"
        />
        <p class="modal-heading">Profile</p>
      </div>
      <div
        class="flex-column center content clickable-item-nohover"
        style="width: 80%"
      >
        <div (click)="toggleProfileEditModal()" class="profile-container">
          <img
            [src]="(profileDetails$ | async)?.profileIcon"
            alt="Profile Image"
            class="profile-image"
          />

          <div class="profile-overlay">
            <img src="../assets/icons/editdark.svg" class="profile-icon" />
          </div>
        </div>
        <ng-container *ngIf="userDetails$ | async as userDetails">
          <p class="profile-name">{{ userDetails.username }}</p>
          <p class="email">{{ userDetails.email }}</p>
        </ng-container>
      </div>

      <div class="button-div">
        <div class="button clickable-item" (click)="toggleTheme()">
          <img
            class="button-icon"
            src="../assets/icons/palette-solid.svg"
            alt="Icon"
          />
          <span class="button-text">Toggle Theme</span>
        </div>
        <div class="button clickable-item">
          <img
            class="button-icon"
            src="../assets/icons/right-from-bracket-solid.svg"
            alt="Icon"
          />
          <span class="button-text">Log Out</span>
        </div>
        <div
          class="button clickable-item"
          (click)="toggleChangePasswordModal()"
        >
          <img
            class="button-icon"
            src="../assets/icons/lock-solid.svg"
            alt="Icon"
          />
          <span class="button-text">Change Password</span>
        </div>
        <div
          class="button clickable-item"
          (click)="toggleConfirmDeleteAccountModal()"
        >
          <img
            class="button-icon"
            src="../assets/icons/trash-solid.svg"
            alt="Icon"
          />
          <span class="button-text">Delete Account</span>
        </div>
      </div>
    </div>
    <div class="picture"></div>
  </div>
</dp-modal-container>

<dp-modal-container
  [modalDisplay]="showChangePasswordModal"
  (close)="toggleChangePasswordModal()"
>
  <div class="flex-row modal" style="width: 70vw; height: 70vh; color: black">
    <div
      class="flex-column center modal-contents"
      style="flex-basis: 55%; gap: 0.7rem"
    >
      <div class="heading-container">
        <img
          src="../assets/icons/back-arrow-right-light.svg"
          alt="Back Arrow"
          class="back-arrow clickable-item"
          (click)="toggleChangePasswordModal()"
        />
        <p class="modal-heading">Change Password</p>
      </div>

      <div class="flex-row" style="width: 80%">
        <p class="modal-step-tag">1</p>
        <div class="flex-column" style="width: 100%">
          <p class="step-heading">Confirm Old Password</p>
          <input
            [(ngModel)]="oldPassword"
            class="default-input"
            type="password"
          />
        </div>
      </div>

      <div class="flex-row" style="width: 80%">
        <p class="modal-step-tag">2</p>
        <div class="flex-column" style="width: 100%">
          <p class="step-heading">New Password</p>
          <input
            [(ngModel)]="newPassword"
            class="default-input"
            type="password"
          />
        </div>
      </div>

      <div class="bottom-div">
        <button
          class="new-domain-btn clickable-item"
          (click)="changePassword()"
        >
          Confirm
        </button>
      </div>
    </div>
    <div class="picture"></div>
  </div>
</dp-modal-container>

<dp-modal-container
  [modalDisplay]="showProfileEditModal"
  (close)="toggleProfileEditModal()"
>
  <div class="flex-row modal" style="width: 70vw; height: 70vh; color: black">
    <div
      class="flex-column center modal-contents"
      style="flex-basis: 55%; gap: 0.7rem"
    >
      <div class="heading-container">
        <img
          src="../assets/icons/back-arrow-right-light.svg"
          alt="Back Arrow"
          class="back-arrow clickable-item"
          (click)="toggleProfileEditModal()"
        />
        <p class="modal-heading">Edit Profile</p>
      </div>

      <div class="flex-row" style="width: 80%">
        <div class="flex-column center" style="width: 100%">
          <div class="wrapper">
            <div class="file-upload">
              <input
                type="file"
                (change)="onImageSelected($event)"
                accept="image/*"
                style="height: 100%; width: 100%; border-radius: 50%"
              />
              <img
                *ngIf="imagePreview"
                [src]="imagePreview"
                alt="Preview"
                class="preview-image"
              />
              <img
                *ngIf="!imagePreview"
                src="../assets/icons/up-arrow.svg"
                class="profile-icon"
              />
            </div>
          </div>
        </div>
      </div>

      <div class="bottom-div">
        <button class="new-domain-btn clickable-item" (click)="uploadImage()">
          Confirm
          <div [ngClass]="{ 'button-spinner': uploadSpinner }"></div>
        </button>
      </div>
    </div>
    <div class="picture"></div>
  </div>
</dp-modal-container>

<dp-modal-container
  [modalDisplay]="showConfirmDeleteDomainModal"
  (close)="toggleConfirmDeleteDomainModal()"
>
  <div
    class="flex-row modal"
    style="width: 30vw; height: 25vh; color: black; border-radius: 10px"
  >
    <div class="flex-row center" style="width: 100%">
      <div class="flex-column center" style="gap: 2rem">
        <p class="confirm-text">
          Are you sure you want to delete your domain?
        </p>
        <div class="button-div">
          <div
            class="confirm-button clickable-item green center"
            (click)="deleteDomain()"
          >
            <img class="button-icon" src="../assets/icons/yes.svg" alt="Icon" />
            <span class="button-text" style="margin-left: 0">Yes</span>
          </div>
          <div
            class="confirm-button clickable-item red center"
            (click)="toggleConfirmDeleteDomainModal()"
          >
            <img class="button-icon" src="../assets/icons/no.svg" alt="Icon" />
            <span class="button-text" style="margin-left: 0">No</span>
          </div>
        </div>
      </div>
    </div>
  </div>
</dp-modal-container>

<dp-modal-container
  [modalDisplay]="showConfirmDeleteAccountModal"
  (close)="toggleConfirmDeleteAccountModal()"
>
  <div
    class="flex-row modal"
    style="width: 30vw; height: 25vh; color: black; border-radius: 10px"
  >
    <div class="flex-row center" style="width: 100%">
      <div class="flex-column center" style="gap: 2rem">
        <p class="confirm-text">
          Are you sure you want to delete your account?
        </p>
        <div class="button-div">
          <div
            class="confirm-button clickable-item green center"
            (click)="toggleDeleteAccountModal()"
          >
            <img class="button-icon" src="../assets/icons/yes.svg" alt="Icon" />
            <span class="button-text" style="margin-left: 0">Yes</span>
          </div>
          <div
            class="confirm-button clickable-item red center"
            (click)="toggleConfirmDeleteAccountModal()"
          >
            <img class="button-icon" src="../assets/icons/no.svg" alt="Icon" />
            <span class="button-text" style="margin-left: 0">No</span>
          </div>
        </div>
      </div>
    </div>
  </div>
</dp-modal-container>

<dp-modal-container
  [modalDisplay]="showDeleteAccountModal"
  (close)="toggleDeleteAccountModal()"
>
  <div
    class="flex-row modal"
    style="width: 30vw; height: 25vh; color: black; border-radius: 10px"
  >
    <div class="flex-row center" style="width: 100%">
      <div class="flex-column center" style="gap: 2rem">
        <div class="flex-column" style="width: 100%">
          <p class="step-heading">Enter Password to Confirm</p>
          <input
            [(ngModel)]="password"
            type="password"
            class="default-input"
            name="password"
          />
        </div>
        <div class="button-div">
          <div
          class="delete-account-button clickable-item red center"
          (click)="deleteAccount()"
        >
          <img
            class="button-icon"
            src="../assets/icons/trash-solid.svg"
            alt="Icon"
          />
          <span class="button-text" style="margin-left: 0">Delete Account</span>
        </div>
          <div
            class="delete-account-button clickable-item green center"
            (click)="toggleDeleteAccountModal()"
          >
            <img class="button-icon" src="../assets/icons/no.svg" alt="Icon" />
            <span class="button-text" style="margin-left: 0">Cancel</span>
          </div>
        </div>
        
      </div>
    </div>
  </div>
</dp-modal-container>
